<style>
    .add-rate {
        width: 1026px;
        float: right;
        background: #fff;
    }
    .add-rate .add-rate-head {
        background: #89affa;
        color: #fff;
        padding: 0px 24px;
        height: 40px;
        line-height: 40px;
    }
    .add-rate .add-rate-head  span a.add-rate-company {
        font-size: 14px;
    }
    .add-rate .add-rate-head  span a em {
        color: #fff;
        font-size: 14px;
    }
    .add-rate table {
        margin: 13px;
    }
    .add-rate table thead {
        border-bottom: 1px solid rgb( 232, 235, 252 );
        background: #fff;
    }
    .add-rate table thead tr td {
        width: 1000px;
        padding: 14px 11px;
        font-size: 14px;
        margin-left: 15px;
    }
    .add-rate table tbody tr {
        border-bottom: 1px dashed rgb( 232, 235, 252 );
    }
    .add-rate table tbody tr td >a >img{
        width: 73px;
        height: 74px;
        float: left;
        margin-top: 20px;
        border: 1px solid rgb( 231, 231, 231 );
    }
    .add-rate table tbody tr td .add-rate-item-info {
        display: inline-block;
        width: 200px;
        float: left;
        margin-top: 15px;
    }
    .add-rate table tbody tr td .add-rate-item-introduce {
        display: block;
        margin: 0px 10px;
        font-size: 14px;
    }
    .add-rate table tbody tr td .add-rate-item-introduce span {
        float: left;
    }
    .add-rate table tbody tr td .add-rate-item-introduce span.add-rate-item-link {
        max-width: 200px;
        overflow: hidden;
        text-overflow: ellipsis;
        display: inline-block;
        white-space: nowrap;
        height: 27px;
        line-height: 27px;
    }
    .add-rate table tbody .record-num {
        border: none;
    }
    .add-rate table tbody .record-num td .count-tip{
        float: right;
        margin-right: 10px;
    }
    .add-rate .submitBox {
        text-align: center;
        margin: 35px auto;
    }
    .add-rate .submitBox label {
        font-size: 14px;
        font-weight: normal;
        margin-right: 22px;
    }
    .add-rate .submitBox >span.submit-btn {
        font-size: 14px;
        padding: 4px 17px;
        background: #5078cb;
        color: #fff;
    }
    .add-rate table thead tr.line01 td >span {
        margin-left: 5px;
        float: left;
        margin-top: 5px;
    }
    .add-rate table thead tr.line01 td >span >img {
        margin-right: 5px;
        margin-bottom: 3px;
    }
    .add-rate table thead tr.line02 td >span >img {
        margin-left: -3px;
    }
    .add-rate table thead tr td >div {
        display: inline-block;
        width: 43%;
        background: #f9f9f9;
        padding: 5px 10px;
        cursor: default;
    }
    .add-rate table thead tr td >div >span {
        display: block;
    }
    .add-rate table thead tr td >div >span.add-rate-item01 span {
        float: right;
        display: block;
        width: 329px;
        height: 50px;
        word-break: break-all;
        overflow-y: scroll;
    }
    .add-rate table thead tr td >div >span.add-rate-item02 {
        margin-top: 18px;
        color: #999;
        font-size: 12px;
    }
    .add-rate table thead tr.line01 {
        border-bottom: 1px solid rgb( 232, 235, 252 );
    }
    .add-rate table thead tr.line02 {
        background: #f5f8fe;
    }
    .add-rate table thead tr.line02 .describe-title {
        color: #5078cb;
        font-weight: bold;
        margin-left: 15px;
    }
    .add-rate table thead tr.line02 .describe-option {
        margin-right: 55px;
    }
    .add-rate table .batch-reply, .add-rate .reply-box .modal-btn {
        color: #fff;
        background: #ff8623;
        border-radius: 3px;
        padding: 4px 10px;
        float: right;
        cursor: pointer;
    }
    .add-rate table tbody .single-reply {
        position: absolute;
        top: 61px;
        left: 265px;
    }
    .add-rate table .buyer-first-rate {
        width: 726px;
        float: right;
        margin-top: 12px;
    }
    .add-rate table .buyer-first-rate >div {
        width: 311px;
        display: inline-block;
        background: #f9f9f9;
        padding: 0 10px;
        overflow: hidden;
        height: 87px;
        position: relative;
        cursor: default;
    }
    .add-rate table .buyer-first-rate >div >div {
    }
    .add-rate table .buyer-first-rate >div .rate-date {
        color: #999;
        margin-top: 10px;
    }
    .add-rate table .buyer-first-rate .buyer-first-rate02 >div {
        display: inline-block;
    }
    .add-rate table .buyer-first-rate .buyer-first-rate02 >div >span {
        display: block;
        margin-top: 10px;
    }
    .add-rate table .buyer-first-rate .buyer-first-rate02 >div >span img{
        margin-right: 3px;
        position: relative;
        top: -2px;
    }
    .add-rate table .buyer-first-rate .comment {
        width: 215px;
        float: right;
        height: 67px;
    }
    .add-rate table .buyer-first-rate .comment span{
        height: 60px;
        width: 215px;
        overflow-y: auto;
        word-break: break-all;
    }
    .add-rate table .buyer-first-rate >div.isLeft {
        margin-left: 100px;
    }
    .add-rate table .buyer-first-rate >div.isRight {
        float: right;
    }
    .add-rate .reply-box {
        position: fixed;
        width: 391px;
        min-height: 282px;
        background: #fff;
        top: 187px;
        left: 650px;
        box-shadow: 2.5px 4.33px 5px 0px rgb( 187, 186, 186 );
        padding-left: 35px;
        padding-top: 30px;
    }
    .add-rate .reply-box >img {
        position: absolute;
        top: 10px;
        right: 10px;
        cursor: pointer;
    }
    .add-rate .reply-box .modal-head {
        width: 324px;
        height: 30px;
        border: 1px solid rgb( 233, 233, 233 );
        padding-left: 10px;
    }
    .add-rate .reply-box .modal-select {
        width: 200px;
        height: 30px;
        display: inline-block;
        margin-left: 42px;
        cursor: default;
        background: #fff;
    }
    .add-rate .reply-box .modal-list {
        position: absolute;
        left: 124px;
        z-index: 100;
        box-shadow: 0 6px 12px rgba(0,0,0,.175);
    }
    .add-rate .reply-box .modal-list >span {
        width: 200px;
        height: 30px;
        line-height: 30px;
        cursor: pointer;
        overflow: hidden;
        color: #999;
        font-size: 12px;
        text-align: center;
        background: #efedee;
        padding: 0;
        display: block;
    }
    .add-rate .reply-box .modal-list >span:hover {
        background: #efedee;
        color: #999;
    }
    .add-rate .reply-box .modal-list >span img{
        margin-right: 8px;
        margin-bottom: 3px;
    }
    .add-rate .reply-box ul {
        max-height: 120px;
        overflow-y: auto;
        overflow-x: hidden;
    }
    .add-rate .reply-box ul li {
        width: 200px;
        height: 30px;
        line-height: 30px;
        background: #fff;
        padding-left: 12px;
        cursor: pointer;
        overflow: hidden;
    }
   /* .add-rate .reply-box ul li.add-modal {
        color: #999;
        font-size: 12px;
        text-align: center;
        background: #efedee;
        padding: 0;
    }*/
    .add-rate .reply-box ul li.add-modal img {
        margin-right: 8px;
        margin-bottom: 3px;
    }
    .add-rate .reply-box ul li:hover {
        background: #5079cb;
        color: #fff;
    }
   /* .add-rate .reply-box ul li.add-modal:hover {
        background: #efedee;
        color: #999;
    }*/
    .add-rate .reply-box .reply-box-text {
        margin-top: 10px;
        position: relative;
    }
    .add-rate .reply-box .reply-box-text >textarea {
        width: 325px;
        height: 156px;
        display: block;
        background: #f9f9f9;
        font-size: 14px;
        color: #999;
        padding-top: 10px;
        padding-left: 10px;
        overflow-y: scroll;
        border: 1px solid rgb( 233, 233, 233 );
        resize: none;
        padding-bottom: 15px;
    }
    .add-rate .reply-box .reply-box-btn {
        text-align: center;
        margin-top: 15px;
        width: 324px;
    }
    .add-rate .reply-box .reply-box-btn .modal-btn {
        float: none;
        border-radius: 0;
        font-size: 14px;
        margin-right: 10px;
    }
    .add-rate .reply-box .reply-box-btn .modify-modal {
    }
    .add-rate .reply-box .reply-box-btn .cancel-modal {
        background: #c2c3c5;
    }
    .add-rate .reply-box .reply-box-btn .submit-modal {
        background: #5079cb;
        margin: 0;
    }
    .add-rate .reply-box .reply-box-text >textarea.active{
        background: #fff;
        color: #333;
    }
    .add-rate .reply-box .reply-box-text .add-rate-remind {
        position: absolute;
        bottom: 2px;
        right: 50px;
        font-size: 12px;
        color: #999;
    }
    .add-rate .reply-box .reply-box-text >textarea:-moz-placeholder { /* Mozilla Firefox 4 to 18 */
        color: #999;
        font-size: 12px;
    }

    .add-rate .reply-box .reply-box-text >textarea::-moz-placeholder { /* Mozilla Firefox 19+ */
        color: #999;
        font-size: 12px;
    }

    .add-rate .reply-box .reply-box-text >textarea:-ms-input-placeholder{
        color: #999;
        font-size: 12px;
    }

    .add-rate .reply-box .reply-box-text >textarea::-webkit-input-placeholder{
        color: #999;
        font-size: 12px;
    }
    .add-rate .bg-f5f8fe {
        background: #f5f8fe!important;
    }
    .buyer-contact-info {
        position: absolute;
        z-index: 2;
        height: 155px;<!--506-->
        border: 1px solid #E7E5E2;
        opacity: 1;
        background-color: white;
        width: 600px;
        top: 40px;
        left: -130px;
        border: 1px solid #E7E5E2;
        -webkit-box-shadow: 0 5px 15px rgba(0,0,0,.5);
        box-shadow: 0 5px 15px rgba(0,0,0,.5);
    }

    .display-none {
        display: none;
    }
    .buyer-contact .contact-title {
        height: 26px;
        background-color: #5078cb;
        text-align: right;
        padding-right: 15px;
        line-height: 26px;
        color: white;
    }

    .buyer-contact .contact-title a, .buyer-contact .contact-title a:hover {
        color: white;
    }

    .buyer-contact .contact-buyer-info {
        margin-left: 24px;
        margin-right: 24px;
        background-color: #5078cb;
        color: #ffffff;
        margin-top: 15px;
        margin-bottom: 12px;
        border-radius: 4px;
        font-family: "Microsoft Yahei", "微软雅黑";
        height: 100px;
    }

    .buyer-contact .contact-buyer-info div {
        text-align: left;
        font-size: 14px;
        padding-left: 15px;
        padding-right: 15px;
    }

    .buyer-contact .contact-buyer-info .company-name {
        text-align: center;
        font-size: 18px;
    }

    .buyer-contact .send-message {
        width: 553px;
        height: 258px;
        background-color: #F7F7F6;
        padding-left: 13px;
        padding-top: 15px;
        border-radius: 4px;
        border: none;
    }

    .buyer-contact .send-button .send{
        width: 100px;
        background-color: #3A76E3;
        color: white;
        display: inline-block;
        border-radius: 3px;
        height: 32px;
        line-height: 32px;
    }
</style>

<div class="add-rate">
    <div class="add-rate-head">
        <span style="width: 27%;">
            <a target="_blank" class="add-rate-company"> <!--href="store/{{::order.storeid}}" -->
               <!-- <img src="static/img/user/images/shop_home.png"/>-->
                <em>{{order.buyername + ' | ' + order.sellername}}</em>
            </a>
        </span>
        <span style="position: relative; width: 10%; margin-left: 50px;">
            <img src="static/img/common/songguo.png"/>
            <a href="javascript:void(0)" class="contact_btn" ng-click="cont = !cont">联系买家</a>
            <div class="buyer-contact" ng-if="cont" ng-class="{true : 'buyer-contact-info', false : 'display-none'}[cont]">
                                 <div class="contact-title">
                                     <a ng-click="setContFalse()"><i class="fa fa-close fa-lg" aria-hidden="true"></i></a>
                                 </div>
                                 <div class="contact-buyer-info">
                                     <div class="company-name" ng-bind="::order.buyername || '买家姓名没获取到'"></div>
                                     <div>
                                         <em>手机：<em ng-bind="::order.buyerTel || '暂无联系电话'"></em></em>
                                         <em style="margin-left: 60px;">邮箱：<em ng-bind="::buyEmail || '暂无电子邮箱'"></em></em>
                                     </div>
                                 </div>
                                 <div style="display: none;">
                                     <textarea class="send-message" placeholder="给买家发送站内消息"></textarea>
                                 </div>
                                 <div style="display: none;" class="send-button"><a class="send">发送</a></div>
                            </div>
        </span>
        <!--<span style="float: right;margin-right: 46px; font-size: 12px;">其他买家需要你的建议喔</span>-->
    </div>
    <table ng-table="showRateTableParams">
        <thead>
        <tr class="line01">
            <td>
                <span ng-if="sellerRateBuyer.level"><img ng-src="static/img/user/images/rate{{sellerRateBuyer.level}}.png" alt="">{{sellerRateBuyer.level == 1?'好评':sellerRateBuyer.level == 2?'中评':'差评'}}</span>
                <div style="margin-left: 20px;" ng-if="sellerRateBuyer.vendorRate">
                    <span class="add-rate-item01">卖家初评：<span ng-bind="sellerRateBuyer.vendorRate"></span></span>
                    <span class="add-rate-item02" ng-bind="sellerRateBuyer.vendorRateTime | date:'yyyy-MM-dd'"></span>
                </div>
                <div style="margin-left: 40px;" ng-if="sellerRateBuyer.vendorAfterRate">
                    <span class="add-rate-item01">卖家追评：<span ng-bind="sellerRateBuyer.vendorAfterRate"></span></span>
                    <span class="add-rate-item02" ng-bind="sellerRateBuyer.vendorRateTime | date:'yyyy-MM-dd'"></span>
                </div>
            </td>
        </tr>
        <tr class="line02">
            <td>
                <span class="describe-title describe-option">店铺评价：</span>
                <span>描述相符：</span>
                <span class="rate-level describe-option">
                    <img ng-if="buyerRateSeller.describeLevel && buyerRateSeller.describeLevel > 0" src="static/img/user/images/rateGood.png" alt="">
                    <img ng-if="buyerRateSeller.describeLevel && buyerRateSeller.describeLevel > 1" src="static/img/user/images/rateGood.png" alt="">
                    <img ng-if="buyerRateSeller.describeLevel && buyerRateSeller.describeLevel > 2" src="static/img/user/images/rateGood.png" alt="">
                    <img ng-if="buyerRateSeller.describeLevel && buyerRateSeller.describeLevel > 3" src="static/img/user/images/rateGood.png" alt="">
                    <img ng-if="buyerRateSeller.describeLevel && buyerRateSeller.describeLevel > 4" src="static/img/user/images/rateGood.png" alt="">
                </span>
                <span>卖家服务：</span>
                <span class="rate-level describe-option">
                    <img ng-if="buyerRateSeller.vendorLevel && buyerRateSeller.vendorLevel > 0" src="static/img/user/images/rateGood.png" alt="">
                    <img ng-if="buyerRateSeller.vendorLevel && buyerRateSeller.vendorLevel > 1" src="static/img/user/images/rateGood.png" alt="">
                    <img ng-if="buyerRateSeller.vendorLevel && buyerRateSeller.vendorLevel > 2" src="static/img/user/images/rateGood.png" alt="">
                    <img ng-if="buyerRateSeller.vendorLevel && buyerRateSeller.vendorLevel > 3" src="static/img/user/images/rateGood.png" alt="">
                    <img ng-if="buyerRateSeller.vendorLevel && buyerRateSeller.vendorLevel > 4" src="static/img/user/images/rateGood.png" alt="">
                </span>
                <span>物流服务：</span>
                <span class="rate-level describe-option">
                    <img ng-if="buyerRateSeller.logisticsLevel && buyerRateSeller.logisticsLevel > 0" src="static/img/user/images/rateGood.png" alt="">
                    <img ng-if="buyerRateSeller.logisticsLevel && buyerRateSeller.logisticsLevel > 1" src="static/img/user/images/rateGood.png" alt="">
                    <img ng-if="buyerRateSeller.logisticsLevel && buyerRateSeller.logisticsLevel > 2" src="static/img/user/images/rateGood.png" alt="">
                    <img ng-if="buyerRateSeller.logisticsLevel && buyerRateSeller.logisticsLevel > 3" src="static/img/user/images/rateGood.png" alt="">
                    <img ng-if="buyerRateSeller.logisticsLevel && buyerRateSeller.logisticsLevel > 4" src="static/img/user/images/rateGood.png" alt="">
                </span>
                <span class="batch-reply" ng-click="getModal(null,'allRate')">批量回复</span>
            </td>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="detail in buyerRateGoods">
            <td>
                <a href="store/{{::order.storeid}}#/batchInfo/{{::detail.goodsDetail.batchCode}}" target="_blank"><img ng-src="{{detail.goodsDetail.img || 'static/img/store/common/default.png'}}" width="55" height="55"/></a>
                <div class="add-rate-item-info">
                    <span class="add-rate-item-introduce"><span class="add-rate-item-link">类目：<a href="product#/kinds/{{::detail.goodsDetail.kindUuid}}" target="_blank"><em ng-bind="::detail.goodsDetail.kiName" title="{{::detail.goodsDetail.kiName}}"></em></a><br/></span></span>
                    <span class="add-rate-item-introduce"><span class="add-rate-item-link">型号：<a href="store/{{::order.storeid}}#/batchInfo/{{::detail.goodsDetail.batchCode}}" target="_blank"><em ng-bind="::detail.goodsDetail.cmpCode" title="{{::detail.goodsDetail.cmpCode}}"></em></a><br/></span></span>
                    <span class="add-rate-item-introduce"><span class="add-rate-item-link">品牌：<a href="product#/brand/{{::detail.goodsDetail.branduuid}}/" target="_blank"><em ng-bind="::detail.goodsDetail.brName" title="{{::detail.goodsDetail.brName}}"></em></a></span></span>
                </div>
                <div class="buyer-first-rate">
                    <div class="buyer-first-rate02 isLeft" ng-class="{'bg-f5f8fe':detail.showRateReply && !detail.returnMeg}" style="margin-left: 100px" ng-mouseenter="detail.showRateReply = true" ng-mouseleave="detail.showRateReply = false">
                        <div>
                            <span>买家初评：</span>
                            <span><img ng-src="static/img/user/images/{{detail.level == 1?'rate1.png':detail.level == 2?'rate2.png':'rate3.png'}}" alt=""><span ng-bind="detail.level == 1?'好评':detail.level == 2?'中评':'差评'"></span></span>
                            <span class="rate-date" ng-bind="detail.buyerRateTime | date:'yyyy-MM-dd'"></span>
                        </div>
                        <div class="comment">
                            <span ng-bind="detail.buyerRate"></span></div>
                        <span class="batch-reply single-reply" ng-if="detail.buyerRate != '此用户没有填写评价！' && detail.buyerRate != '此用户未及时做出评价，系统默认好评！'" ng-show="detail.showRateReply && !detail.returnMeg" ng-click="getModal(detail, 'firstRate')">回复</span>
                    </div>
                    <div class="buyer-first-rate02 isRight" ng-class="{'bg-f5f8fe':detail.showAddRateReply && !detail.afterReturnMeg}" ng-mouseenter="detail.showAddRateReply = true" ng-mouseleave="detail.showAddRateReply = false" ng-if="detail.buyerAfterRate">
                        <div>
                            <span>买家追评：</span>
                            <span class="rate-date" ng-bind="detail.buyerAfterRateTime | date:'yyyy-MM-dd'"></span>
                        </div>
                        <div class="comment">
                            <span ng-bind="detail.buyerAfterRate"></span>
                        </div>
                        <span class="batch-reply single-reply" ng-show="detail.showAddRateReply && !detail.afterReturnMeg" ng-click="getModal(detail, 'addRate')">回复</span>
                    </div>
                </div>
                <div class="buyer-first-rate" >
                    <div class="buyer-first-rate02 isLeft" style="margin-left: 100px" ng-if="detail.returnMeg">
                        <div>
                            <span style="color:#6083ce;">卖家回复</span>
                            <span class="rate-date" ng-bind="detail.returnMegTime | date: 'yyyy-MM-dd'"></span>
                        </div>
                        <div class="comment">
                            <span ng-bind="detail.returnMeg"></span></div>
                    </div>
                    <div class="buyer-first-rate02 isRight" ng-if="detail.afterReturnMeg">
                        <div>
                            <span style="color:#6083ce;">卖家回复</span>
                            <span class="rate-date" ng-bind="detail.afterReturnMegTime | date: 'yyyy-MM-dd'"></span>
                        </div>
                        <div class="comment">
                            <span ng-bind="detail.afterReturnMeg"></span></div>
                    </div>
                </div>
            </td>
        </tr>
        <tr class="record-num">
            <td colspan="6">
                <span class="count-tip">显示 <span ng-bind="$$kdnData.start"></span>-<span ng-bind="$$kdnData.end"></span> 条，共 <span ng-bind="$$kdnData.totalElements" style="color: #5078cb;"></span> 条</span>
            </td>
        </tr>
        </tbody>
    </table>
    <div class="reply-box" ng-if="showRateBoxFlag">
        <img src="static/img/vendor/images/rate-box-del.png" ng-click="setShowRateBoxFlag(false)" alt="">
        <div style="position: relative;" ng-show="boxStatus == 1 || boxStatus == 2">
            <label class="check-active" style="height: 34px;line-height: 34px;">
                <input type="checkbox" id="check-act" ng-click="setGo()" ng-checked="boxStatus == 1" class="ng-pristine ng-untouched ng-valid">
                <label for="check-act"></label>
                <span style="font-size: 14px; color: black; font-weight: normal">使用模板</span>
            </label>
            <input type="search" ng-model="modalTempData.modalTitle" ng-show="boxStatus == 1" class="form-control modal-select" ng-focus="setShowModalListFlag(true)" ng-blur="setShowModalListFlag(false)" readonly>
            <div ng-show="showModalListFlag" class="modal-list" ng-mouseenter="setIsInListFlag(true)" ng-mouseleave="setIsInListFlag(false)">
                <ul>
                    <li ng-repeat="modal in modalData" ng-bind="modal.rateTemplateName" ng-click="chooseModal(modal)"></li>
                </ul>
                <span ng-click="addModal()" class="add-modal"><img src="static/img/vendor/images/rate-add.png" alt="">新增模板</span>
            </div>
        </div>
        <div>
            <input type="text" ng-model="modalTempData.modalTitle" ng-change="listenModalTitle()" ng-trim="false" ng-if="boxStatus == 3 || boxStatus == 4" class="modal-head" placeholder="请填写模板名称">
        </div>
        <div class="reply-box-text">
            <textarea id="rateContent" ng-disabled="boxStatus == 1" ng-aria-readonly="boxStatus == 1" ng-trim="false" placeholder="{{boxStatus==2?'请填写您对此评价的回复':boxStatus==3||boxStatus==4?'请填写模板内容':''}}" ng-change="listenRateContent()" ng-class="{'active': boxStatus != 1}" ng-model="modalTempData.rateContent"></textarea>
            <div class="add-rate-remind" ng-show="boxStatus != 1">
                <span>{{modalTempData.rateContent.length || 0}}</span>
                <span>/200</span>
            </div>
        </div>
        <div class="reply-box-btn">
            <span class="modal-btn modify-modal" ng-click="setBoxStatus(4)" ng-show="boxStatus == 1 && modalTempData.modalTitle">修改模板</span>
            <span class="modal-btn cancel-modal" ng-click="setShowRateBoxFlag(false)" ng-show="boxStatus == 1 || boxStatus == 2">取消</span>
            <span class="modal-btn cancel-modal" ng-click="returnStep1()" ng-show="boxStatus == 3 || boxStatus == 4">返回上一步</span>
            <span class="modal-btn submit-modal" ng-show="boxStatus == 3 || boxStatus == 4" ng-click="saveModal()">保存</span>
            <span ng-class="!modalTempData.rateContent || modalTempData.rateContent == ''?'modal-btn cancel-modal':'modal-btn submit-modal'" ng-show="boxStatus == 1 || boxStatus == 2" ng-click="!modalTempData.rateContent || modalTempData.rateContent == ''?'':submitRate()">提交</span>
        </div>
    </div>
</div>
<style>
    /* general
   ****************************************************/
    .ex {
        font: normal 14px/1 "Microsoft Yahei", "微软雅黑" ;
    }
    .ex .table {
        margin-bottom: 0;
        box-shadow: 6px 6px 12px rgba(0,0,0,.175);
    }
    /*表格缝隙颜色*/
    table .before-blank, .table-bordered>tbody>tr>td.before-blank, .table-bordered>tbody>tr>th.before-blank, .table-bordered>tfoot>tr>td.before-blank, .table-bordered>tfoot>tr>th.before-blank, .table-bordered>thead>tr>td.before-blank, .table-bordered>thead>tr>th.before-blank {
        border-right: 13px solid #eee;
    }
    .ex .table-bordered>thead>tr>td, .ex .table-bordered>thead>tr>th {
        border-bottom: none;
    }
    .ex table > thead > tr > th {
        height: 57px;
        color: rgb(255, 255, 255);
        font-size: 14px;
        background: linear-gradient(rgb(93, 134, 220), rgb(12, 53, 136));
        vertical-align: middle !important;
        text-align: center;
        font-weight: normal; /* 400 */
    }
    .ex table td {
        text-align: center;
    }

    .ex .title {
        font-size: 18px;
        font-weight: normal;
        display: inline-block;
        height: 36px;
        line-height: 36px;
        vertical-align: middle;
        text-align: center;
        padding: 0 0.6em;
        margin-bottom: 0;
        color: white;
        background: linear-gradient(rgb(93, 134, 220), rgb(12, 53, 136));
        border-radius: 3px;
    }
    .ex textarea {
        resize: none;
    }

    /* 采购单信息 */
    .pu-info {
        margin-bottom: 30px;
    }
    .pu-info .pay-amount {
        color: red;
        font-weight: 600;
    }


    /* 异常信息汇总 */
    .ex-info-sum {
        line-height: 1.8;
    }
    .ex-info-sum .apply-reason {
        float: left;
    }
    .apply-reason > * > span:first-child {
        font-weight: 600;
    }
    .apply-reason .submit-time > span:nth-child(2) {
        display:  inline-block;
        font-weight: 600;
        padding-left: 0.7em;
    }
    .apply-reason .apply-type > span:nth-child(2) {
        color: rgb(253, 120 ,2);
        display:  inline-block;
        font-weight: 600;
        padding-left: 0.7em;
    }
    .apply-reason .apply-reason-desc {
        margin-top: 0.5em;
    }
    .apply-reason .apply-reason-desc > * {
        vertical-align: top;
    }
    .apply-reason .apply-reason-desc > *:last-child {
        display: inline-block;
        width: 30em;
        height: 10em;
        padding: 0.3em 0.7em;
        margin-top: -0.3em;
        border: 1px solid #ccc;
        border-radius: 3px;
        font-size: 14px;
        resize: none;
    }

    .ex-info-sum .batch-sum {
        float: right;
        width: 45%;
    }
    .ex-info-sum .batch-sum > div:first-child {
        display: inline-block;
        vertical-align: top;
        font: 600 14px/1 "Microsoft Yahei", "微软雅黑" ;
        padding-top: 0.9em;
    }
    .ex-info-sum .batch-sum > ul {
        display: inline-block;
        width: 20em;
        border: 1px solid #eee;
        border-radius: 3px;
        margin-bottom: 0;
        /*padding: 0 0 0 8em;*/
        /*background-color: #eee;*/
        background-color: rgb(243, 254,254);
        padding: 0.5em 1em;
        box-shadow: 6px 6px 12px rgba(0,0,0,.175);
    }
    .ex-info-sum ul > li:nth-child(3n + 0) {
        margin-bottom: 0.5em;
    }
    .ex-info-sum ul > li > span:first-child {
        display: inline-block;
        width: 7em;
    }
    .ex-info-sum ul > li > span:nth-child(2) {
        color: red;
    }
    .ex-info-sum .currency {
        color: hsl(219, 57%, 64%);
    }
    .ex-info-sum .tax > span:last-child {
        color: hsl(219, 57%, 64%);
    }
    .ex-info-sum .total-amount:not(:nth-child(1)) {
        font-weight: 600;
    }

    /* 申请明细 */
    .select-detail {

    }
    .select-detail .u-box {
        overflow-x: auto;
    }
    .select-detail table {
        width: 1500px;
        background-color: white;
    }
    /* 1920+
   ------------------------------------------ */
    @media only screen and (min-width: 1920px) {
        .select-detail .u-box {
            overflow-x: visible;
        }
    }


    /* 操作 */
    .ex-operation {
        padding: 2em;
        text-align: center;
    }
    .ex-operation button[disabled] {
        opacity: 0.7;
    }
    .ex-operation button[disabled]:hover {
        cursor: not-allowed;
        box-shadow: none;
    }
    .ex-operation button {
        padding: 0.3em 0.7em;
        font-size: 2em;
        line-height: normal;
        border: none;
        width: 18%;
        border-radius: 3px;
    }
    .ex-operation button:hover {
        box-shadow: 0 0 0 2px hsl(11, 97%, 51%);
    }
    .ex-operation .agree-handling, .ex-operation .cancel-apply {
        margin: 0 2em 0 0;
        background: linear-gradient(hsla(4, 85%, 54%, 0.7), hsla(4, 85%, 54%, 1));
        color: white;
    }
    .ex-operation .cancel {
        background: linear-gradient(hsla(45, 3%, 47%, 0.7), hsla(45, 3%, 47%, 1));
        color: white;
    }

</style>
<div class="ex">
    <article>
        <h1 class="title">异常申请 - <span ng-bind="puExSrc[apply.puExSrc]"></span></h1>
        <section class="pu-info">
            <!--<h2>采购单信息</h2>-->
            <table class="table table-bordered">
                <thead>
                <tr>
                    <th>商城下单时间</th>
                    <th>采购单号</th>
                    <th>货源批次数</th>
                    <th>型号数量</th>
                    <th>总数量</th>
                    <th>支付总金额</th>
                    <th>币种</th>
                    <th>税金</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td><span ng-bind="purchase.createtime | date : 'yyyy-MM-dd HH:mm'"></span></td>
                    <td><a ng-href="vendor#/cusPurchase/{{purchase.purchaseid | EncryptionFilter}}">{{purchase.purchaseid}}</a></td>
                    <td><span ng-bind="purchase.batchQty"></span></td>
                    <td><span ng-bind="purchase.cmpQty"></span></td>
                    <td><span ng-bind="purchase.qty"></span></td>
                    <td class="pay-amount"><span ng-bind="purchase.price"></span></td>
                    <td><span ng-bind="purchase.currency"></span></td>
                    <td><span ng-bind="purchase.taxes"></span></td>
                </tr>
                </tbody>
            </table>
        </section>
        <section class="ex-info-sum clearfix">
            <!--<h2>异常信息汇总</h2>-->
            <div class="apply-reason">
                <div class="submit-time">
                    <span>提交时间：</span>
                    <span ng-bind="apply.createTime | date:'yyyy-MM-dd  HH:MM:ss'"></span>
                </div>
                <div class="apply-type">
                    <span>问题类型： </span>
                    <span ng-bind="apply.applyReasonType"></span>
                </div>
                <div class="apply-reason-desc">
                    <span>问题描述： </span>
                    <span ng-bind="apply.applyReason"></span>
                </div>
            </div>
            <div class="batch-sum">
                <div>待处理批次汇总：</div>
                <ul class="list-unstyled">
                    <li><span>货源批次数:</span> <span ng-bind="apply.batchQty"></span></li>
                    <li><span>型号数量：</span> <span ng-bind="apply.cmpQty"></span></li>
                    <li><span>产品总数量：</span> <span ng-bind="apply.prodQty"></span></li>
                    <li>
                        <span>产品总金额：</span>
                        <span ng-bind="apply.totalAmount | number:2"></span>
                        <span class="currency" ng-bind="purchase.currency"></span>
                    </li>
                    <li>
                        <span>运费合计：</span>
                        <span ng-bind="apply.freight | number:2"></span>
                        <span class="currency" ng-bind="purchase.currency"></span>
                    </li>
                    <li class="tax">
                        <span>税率：</span>
                        <span ng-switch="purchase.currency">
                            <span ng-switch-when="RMB">17</span>
                            <span ng-switch-when="USD">0</span>
                        </span>
                        <span>%</span>
                    </li>
                    <li class="total-amount">
                        <span>涉及总金额：</span>
                        <span>
                            <span ng-bind="apply.totalAmount | number:2"></span>
                            <span class="currency" ng-bind="purchase.currency"></span>
                        </span>
                    </li>
                </ul>
            </div>
        </section>
        <section class="select-detail">
            <h2 class="title">待处理批次 - 明细</h2>
            <div class="u-box">
                <table class="table table-bordered">
                    <thead>
                    <tr>
                        <th>序号</th>
                        <th>产品型号</th>
                        <th>品牌</th>
                        <th>类目</th>
                        <th>数量</th>
                        <th>金额</th>
                        <th>单价</th>
                        <th class="before-blank">币种</th>

                        <th>申请类型</th>
                        <th>补充说明</th>
                        <th>商城回复类型</th>
                        <th class="before-blank">商城补充说明</th>

                        <th>生产日期</th>
                        <th>库存更新日期</th>
                        <th>包装</th>
                        <th>最小包装数</th>
                        <th>产品批次号</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="detail in apply.applyDetails track by $index">
                        <td>
                            {{$index + 1}}
                        </td>
                        <td><span ng-bind="detail.purchaseDetail.cmpCode"></span></td>
                        <td><span ng-bind="detail.purchaseDetail.brName"></span></td>
                        <td><span ng-bind="detail.purchaseDetail.kiName"></span></td>
                        <td><span ng-bind="detail.purchaseDetail.ensurePrice"></span></td>
                        <td><span ng-bind="detail.purchaseDetail.taxUnitPrice"></span></td>
                        <td><span ng-bind="detail.purchaseDetail.number"></span></td>
                        <td class="before-blank"><span ng-bind="detail.purchaseDetail.currencyName"></span></td>

                        <td><span ng-bind="applyTypes[detail.negotiations.last().supToMallApplyType]"></span></td>
                        <td><span ng-bind="detail.negotiations.last().supToMallApplyReason"></span></td>
                        <td><span ng-bind="applyTypes[detail.negotiations.last().mallToSupApplyType]"></span></td>
                        <td class="before-blank"><span ng-bind="detail.negotiations.last().mallToSupApplyReason"></span></td>

                        <td><span ng-bind="detail.purchaseDetail.goodsHistory.produceDate"></span></td>
                        <td><span ng-bind="detail.purchaseDetail.goodsHistory.updateDate | date:'yyyy-MM-dd HH:mm'"></span></td>
                        <td><span ng-bind="detail.purchaseDetail.goodsHistory.packaging || '托盘'"></span></td>
                        <td><span ng-bind="detail.purchaseDetail.goodsHistory.minPackQty"></span></td>
                        <td><span ng-bind="detail.purchaseDetail.batchCode"></span></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </section>
        <section class="ex-operation">
            <!--<h2>操作</h2>-->
            <!--<button ng-if="apply.status == 'MALL_TO_SUP'" class="agree-handling" ng-click="agreeHandling()">同意处理</button>-->
            <!--<button class="cancel-apply" ng-if="apply.status == 'SUP_TO_MALL'" ng-click="cancelApply()">取消</button>-->
            <a href="vendor#/cusPurchase"><button class="cancel">返回</button></a>
        </section>
    </article>
</div>